[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
# Minimal package for dependency management only
# The actual code runs from transformerlab/ directory, not from this package
packages = ["tlab_package_init"]

[project]
name = "transformerlab-api"
version = "0.27.0"
description = "Transformer Lab API"
requires-python = ">=3.11"
dependencies = [
  # Common dependencies with same versions across all platforms
  "aiofiles==24.1.0",
  "alembic==1.17.2",
  "boto3==1.40.70",
  "datasets==3.6.0",
  "diffusers==0.36.0",
  "evaluate==0.4.3",
  "fastapi-users[sqlalchemy,oauth]==15.0.1",
  "hf_xet==1.1.4",
  "httpx-oauth==0.16.1",
  "macmon-python==0.1.2",
  "markitdown[all]==0.1.1",
  "nltk==3.9.1",
  "packaging==24.1",
  "pydantic>=2.0,<3.0",
  "python-multipart==0.0.20",
  "sentencepiece==0.2.0",
  "soundfile==0.13.1",
  "tensorboardX==2.6.2.2",
  "timm==1.0.15",
  "transformerlab==0.0.67",
  "transformerlab-inference==0.2.52",
  "transformers==4.57.1",
  "wandb==0.23.1",
  "werkzeug==3.1.3",
  "controlnet_aux==0.0.10",
  "google-cloud-storage==2.18.2",

]

[project.optional-dependencies]
nvidia = [
  # NVIDIA-specific packages
  "torch==2.9.1",
  "torchaudio==2.9.1",
  "torchvision==0.24.1",
  "nvidia-ml-py==12.575.51",
  # Packages with versions (using no-gpu/nvidia versions)
  "accelerate==1.3.0",
  "aiosqlite==0.20.0",
  "asyncpg==0.30.0",
  "einops==0.8.0",
  "fastapi==0.115.7",
  "mcp[cli]==1.8.1",
  "peft==0.14.0",
  "psutil==6.1.1",
  "python-dotenv==1.0.1",
  "scipy==1.15.1",
  "sentence-transformers==3.4.1",
  "sqlalchemy[asyncio]==2.0.38",
  "tensorboard==2.18.0",
  "tiktoken==0.8.0",
  "watchfiles==1.0.4",
]
rocm = [
  # ROCm-specific packages
  "torch==2.9.1+rocm6.4",
  "torchaudio==2.9.1+rocm6.4",
  "torchvision==0.24.1+rocm6.4",
  "pyrsmi==0.2.0",
  # Packages with ROCm-specific versions
  "accelerate==1.6.0",
  "aiosqlite==0.21.0",
  "asyncpg==0.30.0",
  "einops==0.8.1",
  "fastapi==0.115.12",
  "mcp[cli]==1.9.1",
  "peft==0.15.2",
  "psutil==7.0.0",
  "python-dotenv==1.1.0",
  "scipy==1.15.2",
  "sentence-transformers==4.1.0",
  "sqlalchemy[asyncio]==2.0.40",
  "tensorboard==2.19.0",
  "tiktoken==0.9.0",
  "watchfiles==1.0.5",
]
cpu = [
  # CPU-specific packages
  "torch==2.9.1",
  "torchaudio==2.9.1",
  "torchvision==0.24.1",
  # Packages with versions (using no-gpu/cpu versions)
  "accelerate==1.3.0",
  "aiosqlite==0.20.0",
  "asyncpg==0.30.0",
  "einops==0.8.0",
  "fastapi==0.115.7",
  "mcp[cli]==1.8.1",
  "nvidia-ml-py==12.575.51",
  "peft==0.14.0",
  "psutil==6.1.1",
  "python-dotenv==1.0.1",
  "scipy==1.15.1",
  "sentence-transformers==3.4.1",
  "sqlalchemy[asyncio]==2.0.38",
  "tensorboard==2.18.0",
  "tiktoken==0.8.0",
  "watchfiles==1.0.4",
]
